 <!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üßæ Contrato de Amor (simples)</title>

  <style>
    :root{
      --bg1:#0b1024;
      --bg2:#2b145c;
      --card: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.12);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --accent: #ffd36a;
      --good: #6ef0b6;
      --bad: #ff6b6b;
      --shadow: 0 18px 60px rgba(0,0,0,.40);
      --radius: 22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 900px at 20% 20%, rgba(255,211,106,.16), transparent 60%),
        radial-gradient(900px 700px at 80% 10%, rgba(125,68,255,.22), transparent 55%),
        radial-gradient(1100px 900px at 60% 80%, rgba(0,255,209,.12), transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
      padding: 20px 14px 40px;
    }

    .wrap{max-width:980px;margin:0 auto}
    .top{
      display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;
      margin-bottom:12px;
    }
    .brand{
      display:flex; gap:10px; align-items:center;
      padding:12px 14px;
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, var(--card), rgba(255,255,255,.03));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .logo{
      width:40px;height:40px;border-radius:14px;
      display:grid;place-items:center;
      background: radial-gradient(circle at 30% 30%, rgba(255,211,106,.9), rgba(255,211,106,.2));
      color:#1a102f;
      font-size:20px;
      font-weight:900;
    }
    .brand h1{margin:0;font-size:16px;letter-spacing:.2px}
    .brand p{margin:2px 0 0;color:var(--muted);font-size:12.5px}

    .actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end;}
    button,.chip{
      appearance:none;
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04));
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      font-weight:700;
      letter-spacing:.1px;
      display:inline-flex; gap:8px; align-items:center;
    }
    button:hover{transform:translateY(-1px)}
    button:active{transform:translateY(0)}
    .chip{cursor:default; padding:8px 10px; font-weight:800; color: rgba(255,255,255,.85);}
    .chip b{color:var(--accent)}

    .card{
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, var(--card), rgba(255,255,255,.03));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .paper{padding:16px}
    .doc{
      border:1px solid rgba(255,255,255,.12);
      border-radius: 22px;
      padding:18px 18px 14px;
      background:
        radial-gradient(1000px 550px at 20% 0%, rgba(255,211,106,.10), transparent 60%),
        radial-gradient(900px 650px at 100% 30%, rgba(125,68,255,.16), transparent 55%),
        rgba(255,255,255,.04);
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
    }
    .stamp{
      position:absolute;
      top:14px; right:14px;
      padding:10px 12px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.22);
      background: rgba(0,0,0,.18);
      font-size:12px;
      color: rgba(255,255,255,.88);
      text-align:right;
    }
    .stamp .small{display:block;color:var(--muted);font-weight:700;margin-top:3px}
    .title{
      margin:0;
      font-size:30px;
      line-height:1.12;
      letter-spacing:.2px;
    }
    .subtitle{
      margin:8px 0 0;
      color: var(--muted);
      font-size:14px;
      max-width:72ch;
    }
    .hl{color:var(--accent);font-weight:900}
    .meta{display:flex;flex-wrap:wrap;gap:8px;margin:16px 0 14px}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color:rgba(255,255,255,.86);
      font-size:12.5px;
    }

    .section{
      border-top:1px solid rgba(255,255,255,.10);
      margin-top:14px;
      padding-top:14px;
    }
    .section h3{
      margin:0 0 10px;
      font-size:13px;
      letter-spacing:.2px;
      color:rgba(255,255,255,.86);
      display:flex; gap:8px; align-items:center;
    }
    .clause{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      border-radius:16px;
      padding:10px 12px;
      margin:8px 0;
      display:flex; gap:10px; align-items:flex-start;
    }
    .clause .n{
      min-width:28px; height:28px; border-radius:10px;
      display:grid; place-items:center;
      background: rgba(255,211,106,.16);
      border:1px solid rgba(255,211,106,.22);
      color: rgba(255,211,106,.92);
      font-weight:900;
      font-size:12px;
    }
    .clause .t{flex:1;color:rgba(255,255,255,.90); font-size:14px; line-height:1.35}

    .signBox{
      display:flex; gap:12px; align-items:flex-start; flex-wrap:wrap;
    }
    .sig{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius:16px;
      padding:10px;
    }
    canvas{
      display:block;
      width:320px; height:140px;
      border-radius:12px;
      background: rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.10);
      touch-action:none;
    }
    .sigBtns{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
    .mini{font-size:12px;color:var(--muted);margin-top:6px;line-height:1.35}
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px}
    .videoBox{
      width:360px; max-width:100%;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius:16px;
      padding:10px;
    }
    video{
      width:100%;
      border-radius:12px;
      background: rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.10);
    }

    .statusPill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      font-size:12.5px;
    }
    .dot{width:8px;height:8px;border-radius:99px;background:var(--bad); box-shadow:0 0 18px rgba(255,107,107,.35)}
    .ok{color: rgba(110,240,182,.95); font-weight:900}
    .err{color: rgba(255,107,107,.95); font-weight:900}

    .foot{
      display:flex; gap:12px; align-items:flex-end; justify-content:space-between; flex-wrap:wrap;
      margin-top:14px;
      border-top:1px solid rgba(255,255,255,.10);
      padding-top:14px;
    }

    /* Overlay: ‚ÄúAnexar v√≠deo‚Äù (local) */
    .overlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.70);
      display:none;
      place-items:center;
      padding:14px;
      z-index:9999;
    }
    .overlay.show{display:grid;}
    .modal{
      width:min(540px, 100%);
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(20,20,30,.78);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(14px);
    }
    .modalH{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      padding:12px 14px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .modalH .t{font-size:13px; color: rgba(255,255,255,.90); font-weight:900}
    .modalB{padding:14px}
    input[type="file"]{
      width:100%;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      color:var(--text);
      padding:10px 12px;
      outline:none;
    }

    @media (max-width: 520px){
      .title{font-size:26px}
      canvas{width:100%;}
      .videoBox{width:100%}
    }

    @media print{
      body{background:#fff; color:#000; padding:0}
      .top{display:none}
      .card{box-shadow:none; border:none; background:#fff}
      .paper{padding:0}
      .doc{box-shadow:none; border:1px solid #ddd; background:#fff}
      .pill,.sig,.videoBox,.stamp{border-color:#ddd; background:#fff}
      .hl{color:#b98400}
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="top">
      <div class="brand">
        <div class="logo">üßæ</div>
        <div>
          <h1>Contrato de Amor (Simples)</h1>
          <p>Sem l√≥gica autom√°tica. O texto que aparece est√° escrito aqui no c√≥digo.</p>
        </div>
      </div>

      <div class="actions">
        <span class="chip">Protocolo: <b id="protoChip">AUTO</b></span>
        <button id="btnAttach" type="button">üìé Anexar v√≠deo</button>
        <button id="btnPrint" type="button">üñ®Ô∏è Imprimir</button>
      </div>
    </div>

    <div class="card">
      <div class="paper">
        <div class="doc" id="doc">
          <div class="stamp">
            <div><b id="proto">AUTO</b></div>
            <span class="small" id="stampDT">AUTO</span>
          </div>

          <!-- ‚úÖ MUDE O TEXTO DIRETO AQUI -->
          <h1 class="title"><span class="hl">üßæ</span> <span id="docTitle">Contrato de Amor</span></h1>
          <p class="subtitle" id="docSubtitle">Um acordo s√©rio o suficiente pra valer ‚Äî e leve o bastante pra sorrir. üíõ</p>

          <div class="meta">
            <span class="pill">üë§ A: <b id="mA">Eu</b></span>
            <span class="pill">üë§ B: <b id="mB">Voc√™</b></span>
            <span class="pill">üóÇÔ∏è Tipo: <b id="mKind">Namoro</b></span>
            <span class="pill">üé≠ Tom: <b id="mTone">Rom√¢ntico</b></span>
          </div>

          <p style="margin:0;color:rgba(255,255,255,.88);font-size:15px;line-height:1.45" id="pIntro">
            Pelo presente instrumento, Eu e Voc√™ declaram, com o cora√ß√£o tranquilo e os olhos brilhando, que desejam firmar um acordo de carinho, parceria e presen√ßa.
          </p>

          <div class="section">
            <h3>‚ú® Declara√ß√£o</h3>

            <!-- ‚úÖ A FRASE "EU, VOC√ä..." FICA AQUI (e voc√™ edita direto) -->
            <div style="font-size:22px;font-weight:900;line-height:1.2;margin-top:2px">
              <span id="pHead">Eu e Voc√™, aceita namorar comigo?üò≥üò≥üò≥</span>
            </div>

            <div class="mini">Dica: essa linha √© perfeita pro v√≠deo/an√∫ncio.</div>
          </div>

          <div class="section">
            <h3>üìå Cl√°usulas</h3>
            <div id="clauseList"></div>
            <div class="mini" id="clauseHint"></div>
          </div>

          <div class="section">
            <h3>üìé Anexo em v√≠deo</h3>
            <div class="videoBox">
              <video id="video" controls playsinline preload="metadata"></video>
              <div class="mini" id="videoNote">Sem v√≠deo anexado.</div>
            </div>
          </div>

          <div class="section">
            <h3>‚úçÔ∏è Assinaturas</h3>

            <div class="signBox">
              <div class="sig">
                <div style="display:flex;gap:10px;align-items:center;justify-content:space-between">
                  <div style="font-weight:900">Assinatura do(a) <span class="hl" id="sigNameA">Eu</span></div>
                  <div class="mini" id="sigOk" style="margin:0">N√£o assinado</div>
                </div>

                <canvas id="pad" width="640" height="280"></canvas>

                <div class="sigBtns">
                  <button id="btnClear" type="button">üßΩ Limpar</button>
                  <button id="btnSaveSig" type="button">üíæ Salvar</button>
                  <button id="btnUndo" type="button">‚Ü©Ô∏è Desfazer</button>
                </div>
                <div class="mini">No celular, assine com o dedo. No PC, com mouse.</div>
              </div>

              <div class="sig" style="min-width:260px;max-width:360px">
                <div style="font-weight:900;margin-bottom:8px">‚úÖ Status do acordo</div>

                <div class="statusPill" style="margin-bottom:8px">
                  <span class="dot" id="statusDot"></span>
                  <span id="statusTxt" class="err">Pendente</span>
                </div>

                <div class="mini" id="statusHelp">Assine e clique em <b>Assinar &amp; Finalizar</b>.</div>

                <div style="height:1px;background:rgba(255,255,255,.10);margin:12px 0"></div>

                <button id="btnFinalize" type="button" style="width:100%;justify-content:center">üßæ Assinar &amp; Finalizar</button>
                <div class="mini">Ao finalizar, fica ‚Äútravado‚Äù (bom pra gravar v√≠deo).</div>

                <div style="height:1px;background:rgba(255,255,255,.10);margin:12px 0"></div>

                <button id="btnUnlock" type="button" style="width:100%;justify-content:center;opacity:.9">üîì Reabrir edi√ß√£o</button>
              </div>
            </div>
          </div>

          <div class="foot">
            <div class="mini">
              <b>Carimbo:</b> <span id="footDT">AUTO</span><br/>
              <b>Protocolo:</b> <span class="kbd" id="footProto">AUTO</span>
            </div>
            <div class="mini" style="text-align:right">
              ‚ÄúSe for pra ser, que seja com <span class="hl">termos claros</span> e <span class="hl">carinho infinito</span>.‚Äù üíõ
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>

  <!-- Modal anexar v√≠deo local -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="modal">
      <div class="modalH">
        <div class="t">üìé Anexar v√≠deo (local)</div>
        <button id="btnCloseModal" type="button">‚úñÔ∏è Fechar</button>
      </div>
      <div class="modalB">
        <input id="videoFile" type="file" accept="video/*" />
        <div class="mini">Isso n√£o faz upload. √â s√≥ pra voc√™ testar/gravar v√≠deos.</div>
      </div>
    </div>
  </div>

  <script>
    
    // =====================================================
    // ‚úÖ M√çDIA FIXA (modo "bota o arquivo na pasta e aparece")
    // Coloque os arquivos na MESMA pasta do index.html (no GitHub Pages/Vercel):
    //   - video.mp4  (ou .webm / .mov)
    //   - foto.jpg   (ou .png / .webp)   [opcional]
    //   - audio.mp3  (ou .m4a / .wav)    [opcional]
    //
    // Se quiser for√ßar, preencha abaixo. Se deixar vazio, ele tenta achar por nomes comuns.
    const FIXED_MEDIA = {
      videoUrl: "",   // ex: "video.mp4"
      photoUrl: "",   // ex: "foto.jpg"
      audioUrl: ""    // ex: "audio.mp3"
    };

    const AUTO_MEDIA_CANDIDATES = {
      video: ["video.mp4","video.webm","video.mov","surpresa.mp4","clip.mp4"],
      photo: ["foto.jpg","foto.jpeg","foto.png","foto.webp","capa.jpg","capa.png","photo.jpg","photo.png"],
      audio: ["audio.mp3","audio.m4a","audio.wav","audio.ogg","voz.mp3","voz.m4a","musica.mp3","musica.m4a"]
    };

    async function existsOnServer(url){
      try{
        const r = await fetch(url, { method: "HEAD", cache: "no-store" });
        if(r.ok) return true;
      }catch(e){}
      try{
        const r2 = await fetch(url, { method: "GET", headers: { "Range": "bytes=0-0" }, cache: "no-store" });
        if(r2.ok || r2.status === 206) { try{ r2.body?.cancel(); }catch(e){} return true; }
      }catch(e){}
      return false;
    }
    async function pickFirstExisting(list){
      for(const u of list){
        if(await existsOnServer(u)) return u;
      }
      return "";
    }

// =====================================================
    // ‚úÖ SCRIPT SIMPLES:
    // - N√£o gera frases autom√°ticas
    // - S√≥ cuida de: protocolo/data, assinatura, v√≠deo local
    // =====================================================

    const $ = (id)=>document.getElementById(id);

    // --- protocolo/data: se estiver "AUTO", o script preenche ---
    function pad2(n){ return String(n).padStart(2, "0"); }
    function nowStr(){
      const d = new Date();
      return `${pad2(d.getDate())}/${pad2(d.getMonth()+1)}/${d.getFullYear()} ${pad2(d.getHours())}:${pad2(d.getMinutes())}`;
    }
    function randProto(){
      const d = new Date();
      const y = d.getFullYear();
      const m = pad2(d.getMonth()+1);
      const day = pad2(d.getDate());
      const r = Math.random().toString(36).slice(2,10).toUpperCase();
      return `PROTO-${y}-${m}${day}-${r}`;
    }
    function setAutoText(id, value){
      const el = $(id);
      if(!el) return;
      const t = (el.textContent || "").trim().toUpperCase();
      if(t === "AUTO" || t === "‚Äî" || t === "") el.textContent = value;
    }

    const proto = randProto();
    const dt = nowStr();

    setAutoText("proto", proto);
    setAutoText("protoChip", proto);
    setAutoText("footProto", proto);

    setAutoText("stampDT", `Carimbo: ${dt}`);
    setAutoText("footDT", dt);

    // --- cl√°usulas: escreve aqui no JS (bem simples) ---
    const CLAUSES = [
      "As partes concordam em manter um m√≠nimo de 1 (um) carinho di√°rio. üíõ",
      "Em caso de briga: abra√ßo obrigat√≥rio por 20 segundos (m√≠nimo). ü§ù",
      "Est√° autorizado o uso de apelidos e memes internos (sem abuso). üòÇ"
    ];

    const clauseList = $("clauseList");
    const clauseHint = $("clauseHint");
    clauseList.innerHTML = "";
    if(!CLAUSES.length){
      clauseHint.textContent = "Nenhuma cl√°usula. Edite a lista CLAUSES no script.";
    }else{
      clauseHint.textContent = "";
      CLAUSES.forEach((c, idx)=>{
        const div = document.createElement("div");
        div.className = "clause";
        div.innerHTML = `<div class="n">${idx+1}</div><div class="t">${c}</div>`;
        clauseList.appendChild(div);
      });
    }

    // --- v√≠deo local (sem upload) ---
    const overlay = $("overlay");
    const btnAttach = $("btnAttach");
    const btnCloseModal = $("btnCloseModal");
    const videoFile = $("videoFile");
    const video = $("video");
    const videoNote = $("videoNote");

    let currentVideoUrl = "";


    // --- modo FIXO (video.mp4 do lado do index) ---
    async function tryLoadFixedMedia(){
      const proto = (location && location.protocol) ? location.protocol : "";
      const canFetch = proto === "http:" || proto === "https:";

      // FILE:// n√£o permite checar automaticamente; nesse caso use o bot√£o "Anexar v√≠deo".
      if(!canFetch) return;

      // Se quiser for√ßar, coloque FIXED_MEDIA.videoUrl = "video.mp4"
      let vurl = (FIXED_MEDIA.videoUrl || "").trim();
      if(!vurl) vurl = await pickFirstExisting(AUTO_MEDIA_CANDIDATES.video);

      if(vurl){
        // s√≥ seta se ainda n√£o tem v√≠deo
        if(!video.getAttribute("src") && !video.src){
          video.src = vurl;
          videoNote.textContent = `Anexo: ${vurl}`;
        }
      }
    }
    btnAttach.addEventListener("click", ()=>{
      overlay.classList.add("show");
      overlay.setAttribute("aria-hidden", "false");
    });
    function closeModal(){
      overlay.classList.remove("show");
      overlay.setAttribute("aria-hidden", "true");
    }
    btnCloseModal.addEventListener("click", closeModal);
    overlay.addEventListener("click", (e)=>{ if(e.target === overlay) closeModal(); });

    videoFile.addEventListener("change", ()=>{
      const f = videoFile.files && videoFile.files[0];
      if(!f) return;

      if(currentVideoUrl && currentVideoUrl.startsWith("blob:")){
        try{ URL.revokeObjectURL(currentVideoUrl); }catch{}
      }
      currentVideoUrl = URL.createObjectURL(f);
      video.src = currentVideoUrl;
      videoNote.textContent = `Anexo: ${f.name}`;
      closeModal();
    });

    // --- impress√£o ---
    $("btnPrint").addEventListener("click", ()=> window.print());

    // --- assinatura ---
    const canvas = $("pad");
    const ctx = canvas.getContext("2d");
    const btnClear = $("btnClear");
    const btnSave = $("btnSaveSig");
    const btnUndo = $("btnUndo");
    const btnFinalize = $("btnFinalize");
    const btnUnlock = $("btnUnlock");

    const sigOk = $("sigOk");
    const statusDot = $("statusDot");
    const statusTxt = $("statusTxt");
    const statusHelp = $("statusHelp");

    let finalized = false;
    let signatureDataUrl = "";
    const strokes = [];
    let drawing = false;
    let last = null;
    let currentStroke = null;

    function redraw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = "rgba(255,255,255,.02)";
      ctx.fillRect(0,0,canvas.width,canvas.height);

      ctx.lineCap = "round";
      ctx.lineJoin = "round";
      ctx.lineWidth = 2.6;
      ctx.strokeStyle = "rgba(255,255,255,.92)";

      for(const st of strokes){
        for(let i=1;i<st.length;i++){
          ctx.beginPath();
          ctx.moveTo(st[i-1].x, st[i-1].y);
          ctx.lineTo(st[i].x, st[i].y);
          ctx.stroke();
        }
      }
    }

    function resizeCanvasForHiDPI(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      const w = Math.round(rect.width * dpr);
      const h = Math.round(rect.height * dpr);
      if(canvas.width !== w || canvas.height !== h){
        canvas.width = w;
        canvas.height = h;
      }
      ctx.setTransform(dpr,0,0,dpr,0,0);
      redraw();
    }

    function posFromEvent(e){
      const rect = canvas.getBoundingClientRect();
      const p = (e.touches && e.touches[0]) ? e.touches[0] : e;
      return { x: p.clientX - rect.left, y: p.clientY - rect.top };
    }

    function startDraw(e){
      if(finalized) return;
      drawing = true;
      last = posFromEvent(e);
      currentStroke = [last];
      strokes.push(currentStroke);
    }
    function moveDraw(e){
      if(!drawing || finalized) return;
      const p = posFromEvent(e);
      currentStroke.push(p);
      ctx.beginPath();
      ctx.moveTo(last.x, last.y);
      ctx.lineTo(p.x, p.y);
      ctx.stroke();
      last = p;
      e.preventDefault?.();
    }
    function endDraw(){
      drawing = false;
      last = null;
      currentStroke = null;
    }

    canvas.addEventListener("mousedown", startDraw);
    canvas.addEventListener("mousemove", moveDraw);
    window.addEventListener("mouseup", endDraw);

    canvas.addEventListener("touchstart", (e)=>{ startDraw(e); e.preventDefault(); }, { passive:false });
    canvas.addEventListener("touchmove", (e)=> moveDraw(e), { passive:false });
    canvas.addEventListener("touchend", endDraw);

    function setFinalized(v){
      finalized = v;

      const ids = ["btnClear","btnSaveSig","btnUndo","btnAttach"];
      for(const id of ids){
        const el = $(id);
        if(!el) continue;
        el.disabled = finalized;
        el.style.opacity = finalized ? .65 : "";
        el.style.cursor = finalized ? "not-allowed" : "";
      }

      if(finalized){
        statusDot.style.background = "var(--good)";
        statusDot.style.boxShadow = "0 0 18px rgba(110,240,182,.5)";
        statusTxt.textContent = "Aceito / Assinado";
        statusTxt.className = "ok";
        statusHelp.innerHTML = "Contrato finalizado. (Modo produto) ‚úÖ";
      }else{
        statusDot.style.background = "var(--bad)";
        statusDot.style.boxShadow = "0 0 18px rgba(255,107,107,.35)";
        statusTxt.textContent = "Pendente";
        statusTxt.className = "err";
        statusHelp.innerHTML = "Assine e clique em <b>Assinar &amp; Finalizar</b>.";
      }
    }

    btnClear.addEventListener("click", ()=>{
      if(finalized) return;
      strokes.length = 0;
      signatureDataUrl = "";
      sigOk.textContent = "N√£o assinado";
      sigOk.className = "mini";
      redraw();
    });

    btnUndo.addEventListener("click", ()=>{
      if(finalized) return;
      strokes.pop();
      redraw();
    });

    btnSave.addEventListener("click", ()=>{
      if(finalized) return;
      signatureDataUrl = canvas.toDataURL("image/png");
      sigOk.textContent = "Assinatura salva ‚úÖ";
      sigOk.className = "mini ok";
    });

    btnFinalize.addEventListener("click", ()=>{
      if(!signatureDataUrl){
        alert("Assine e clique em ‚ÄúSalvar‚Äù antes de finalizar.");
        return;
      }
      setFinalized(true);
      try{ video.currentTime = 0; }catch{}
    });

    btnUnlock.addEventListener("click", ()=> setFinalized(false));

    window.addEventListener("resize", resizeCanvasForHiDPI);
    setTimeout(resizeCanvasForHiDPI, 0);
    setFinalized(false);

    // tenta carregar video.mp4 automaticamente (se estiver online)
    tryLoadFixedMedia();
  </script>
</body>
</html>

